-- AoC 2020-03
-- SQL... why not ;-)

create table toboggan (id int generated by default as identity (start with 1) not null primary key, pattern varchar2(100) not null);

insert into toboggan (pattern) values ('.....#.##......#..##..........#');
insert into toboggan (pattern) values ('##.#.##..#............##....#..');
insert into toboggan (pattern) values ('......###...#..............#.##');
insert into toboggan (pattern) values ('.....#..##.#..#......#.#.#..#..');
insert into toboggan (pattern) values ('..#.......###..#..........#.#..');
insert into toboggan (pattern) values ('..#..#.##.......##.....#....#..');
insert into toboggan (pattern) values ('.##....##....##.###.....###..#.');
insert into toboggan (pattern) values ('..##....#...##..#....#.#.#.....');
insert into toboggan (pattern) values ('.....##..###.##...............#');
insert into toboggan (pattern) values ('#.....#..#....#.##...####..#...');
insert into toboggan (pattern) values ('#......#.#....#..#.##....#..#.#');
insert into toboggan (pattern) values ('##.#...#.#............#......#.');
insert into toboggan (pattern) values ('.#####.......#..#.#....#......#');
insert into toboggan (pattern) values ('..#.#....#.#.##...#.##...##....');
insert into toboggan (pattern) values ('.....#.#...#..####.##..#.......');
insert into toboggan (pattern) values ('#....#...##.#.#.##.#..##.....#.');
insert into toboggan (pattern) values ('##.##...#....#...#......#..##..');
insert into toboggan (pattern) values ('....##...#..#.#...#.#.#.....##.');
insert into toboggan (pattern) values ('..#....##......##....#.#....#..');
insert into toboggan (pattern) values ('#..#....#....###..#.##....#.#.#');
insert into toboggan (pattern) values ('..#.#####..##....#....#.....##.');
insert into toboggan (pattern) values ('.#...##.......#...#....#.#...##');
insert into toboggan (pattern) values ('#.#.#.##.......#.....#.#.#....#');
insert into toboggan (pattern) values ('.#.#.....#.......#.......##....');
insert into toboggan (pattern) values ('.#......#....#....#.......##...');
insert into toboggan (pattern) values ('#......#.....#......#..#..#....');
insert into toboggan (pattern) values ('#.#...#...#....##....#.#...#..#');
insert into toboggan (pattern) values ('....#.....##...#...#..#.#......');
insert into toboggan (pattern) values ('..#......#..........#...#.#....');
insert into toboggan (pattern) values ('..#..#......####..##...###.....');
insert into toboggan (pattern) values ('.#.....#...##...#.##........###');
insert into toboggan (pattern) values ('#.#....#..#....#..#.....#.#..#.');
insert into toboggan (pattern) values ('...##.##.#.#.##...#.....#......');
insert into toboggan (pattern) values ('##....#.#.#...####.#.#.#.#.....');
insert into toboggan (pattern) values ('.##.........#..#..###..........');
insert into toboggan (pattern) values ('..##.###.#..#..#....##.....#...');
insert into toboggan (pattern) values ('##........#..###....#.#..#..#..');
insert into toboggan (pattern) values ('....#.#.......##..#.#.#.#......');
insert into toboggan (pattern) values ('....##.....#.........##.......#');
insert into toboggan (pattern) values ('..#........##.#.........###..##');
insert into toboggan (pattern) values ('....#..................##..#...');
insert into toboggan (pattern) values ('#...#.#..###..#.....#..#..#...#');
insert into toboggan (pattern) values ('..#..#.##..#..#.......#.......#');
insert into toboggan (pattern) values ('.....#..##..#....##...........#');
insert into toboggan (pattern) values ('..##...#........#...#.#.......#');
insert into toboggan (pattern) values ('.........#.#..#.#..#.##.#.###..');
insert into toboggan (pattern) values ('....#...#..#..#......##....#.#.');
insert into toboggan (pattern) values ('..#..#.#....#....#..#.####..##.');
insert into toboggan (pattern) values ('##....#.....#......##.###.#..#.');
insert into toboggan (pattern) values ('#..#..##..###......#.#.#.#...#.');
insert into toboggan (pattern) values ('.......#..##..##...#...#..#....');
insert into toboggan (pattern) values ('..#.###.#...#....#.##.#.....##.');
insert into toboggan (pattern) values ('.#.#.......##...##...##....#...');
insert into toboggan (pattern) values ('#...#.#.#...#.####..#..##......');
insert into toboggan (pattern) values ('###..#.##..#..........#...#....');
insert into toboggan (pattern) values ('##.#.........#..##......####...');
insert into toboggan (pattern) values ('..##.#..#....#.##..............');
insert into toboggan (pattern) values ('...#....#.......###............');
insert into toboggan (pattern) values ('...#.....##....#.#.#.#.......##');
insert into toboggan (pattern) values ('###.###...#...#...###.##...##..');
insert into toboggan (pattern) values ('#.#....#.##..#.....#.....##.#..');
insert into toboggan (pattern) values ('...#....#....#.........#....#.#');
insert into toboggan (pattern) values ('##.#....#........#..#..##.#....');
insert into toboggan (pattern) values ('.#.#..#.......#...##.......#...');
insert into toboggan (pattern) values ('.##...##........#....#.#..#....');
insert into toboggan (pattern) values ('....#..#.##.###.....#.#........');
insert into toboggan (pattern) values ('.#.#...#.#..#.....#.........#..');
insert into toboggan (pattern) values ('.......#.#.#..##....#.........#');
insert into toboggan (pattern) values ('.##...#....#..#...#........#..#');
insert into toboggan (pattern) values ('....#....#..#.#..#.#.#....##.##');
insert into toboggan (pattern) values ('..##....#.....##..#.#...#...#..');
insert into toboggan (pattern) values ('#.##.........#.....#.......#.##');
insert into toboggan (pattern) values ('...#...##.#.#..........#......#');
insert into toboggan (pattern) values ('###...#.....#..#.......#####..#');
insert into toboggan (pattern) values ('#.####...##.#.#..#...#.........');
insert into toboggan (pattern) values ('.##.....#.....##..#...##.##....');
insert into toboggan (pattern) values ('.........###...#......##....###');
insert into toboggan (pattern) values ('.#....##...###.#..#...##..#.#.#');
insert into toboggan (pattern) values ('.......#.......#.#...##.#......');
insert into toboggan (pattern) values ('.....#.#........#..##.....##...');
insert into toboggan (pattern) values ('....#.#.........##.#...##..#.#.');
insert into toboggan (pattern) values ('#..#..#.##..#.##.##.....##.###.');
insert into toboggan (pattern) values ('..##.........###...#....#....#.');
insert into toboggan (pattern) values ('.###...#..#.##...........#.....');
insert into toboggan (pattern) values ('#..##..........#..........#....');
insert into toboggan (pattern) values ('.....#.#....#..##..#...#.#....#');
insert into toboggan (pattern) values ('..#.....#.#....#...##.##.......');
insert into toboggan (pattern) values ('##.....##........#....#..##....');
insert into toboggan (pattern) values ('.#..#.#.........#..#..#........');
insert into toboggan (pattern) values ('.............##....#....#..#...');
insert into toboggan (pattern) values ('....##....#..#.#.##....###.##.#');
insert into toboggan (pattern) values ('.###..#.....#..#..##..#..##..#.');
insert into toboggan (pattern) values ('...#..###.......#.#....#..###..');
insert into toboggan (pattern) values ('#.#..#.....#...#......#........');
insert into toboggan (pattern) values ('#..#..............###.#......#.');
insert into toboggan (pattern) values ('..#....##.#....#.##.#.#...#....');
insert into toboggan (pattern) values ('.........##..#...#.#.......#...');
insert into toboggan (pattern) values ('........#...#.#....#.....##..#.');
insert into toboggan (pattern) values ('...#.##..#..#..###..#..#......#');
insert into toboggan (pattern) values ('.....####......#...#....#...#.#');
insert into toboggan (pattern) values ('...###.#.#......#....#.......#.');
insert into toboggan (pattern) values ('#...##.#....#....##....##.###..');
insert into toboggan (pattern) values ('.......##...##.....#.##.#..#..#');
insert into toboggan (pattern) values ('.....#.#............##...#.####');
insert into toboggan (pattern) values ('.##..#.#.#.#..#.#.#.....#.##...');
insert into toboggan (pattern) values ('.#..####...#.#....#.....#..#...');
insert into toboggan (pattern) values ('....##..#.#...#..#....#.#......');
insert into toboggan (pattern) values ('...#......###..#..###..#.....#.');
insert into toboggan (pattern) values ('.#.#.#..##....#...##..#.....#..');
insert into toboggan (pattern) values ('###....#....#...##.....#...#...');
insert into toboggan (pattern) values ('#.##....#......#...###.........');
insert into toboggan (pattern) values ('.#..#.#...#..#....#....#....#..');
insert into toboggan (pattern) values ('...............##...####..#..#.');
insert into toboggan (pattern) values ('#.#...........####..#...##.....');
insert into toboggan (pattern) values ('##.#....#........#......#...##.');
insert into toboggan (pattern) values ('......#...#...#....#....#.....#');
insert into toboggan (pattern) values ('#......#.............#....###..');
insert into toboggan (pattern) values ('.#...#...##.....#...##.##..#...');
insert into toboggan (pattern) values ('..#.#......#.#........#........');
insert into toboggan (pattern) values ('.......#..#.#...##..#.#.#......');
insert into toboggan (pattern) values ('..##...#.##........#....#.#...#');
insert into toboggan (pattern) values ('.....#..#..#........#.#......##');
insert into toboggan (pattern) values ('....#.#...##............##....#');
insert into toboggan (pattern) values ('.#.#....#.#.#...#...#.##.....#.');
insert into toboggan (pattern) values ('#.#.##...#....#.#.#..#.##..#.#.');
insert into toboggan (pattern) values ('.........####..#...#...#.......');
insert into toboggan (pattern) values ('#..#..####......#..##..#...#...');
insert into toboggan (pattern) values ('.........##..................#.');
insert into toboggan (pattern) values ('.....##.#..##.#.#...#......##..');
insert into toboggan (pattern) values ('...#....#....#.#.....#...#..#.#');
insert into toboggan (pattern) values ('#...##.#...##...........#..#...');
insert into toboggan (pattern) values ('#..........#.#..#..#.##..#..#.#');
insert into toboggan (pattern) values ('.#...#.##...#.#.#..#.......##..');
insert into toboggan (pattern) values ('.........#...........#..#..#...');
insert into toboggan (pattern) values ('.##...##....#.#......#........#');
insert into toboggan (pattern) values ('#.#...........#....#.......#...');
insert into toboggan (pattern) values ('##.#.#.......#...###......##..#');
insert into toboggan (pattern) values ('...###..#.##..##.#.#.......#...');
insert into toboggan (pattern) values ('.#...#..##.#...#........#.....#');
insert into toboggan (pattern) values ('...#.......#..#..........#.#...');
insert into toboggan (pattern) values ('..#.#.#.#.....#.#.......#..#..#');
insert into toboggan (pattern) values ('#.##.....#..##...#..###.#....#.');
insert into toboggan (pattern) values ('.......#...........#...#....###');
insert into toboggan (pattern) values ('.......#..#...#.............#..');
insert into toboggan (pattern) values ('#.....###.......#...#........#.');
insert into toboggan (pattern) values ('.#..#..#..#...........#........');
insert into toboggan (pattern) values ('....#.#...#.#.##.#.#....#.##..#');
insert into toboggan (pattern) values ('.......#..##...##...#...#......');
insert into toboggan (pattern) values ('...#.....##.###...#.#...##....#');
insert into toboggan (pattern) values ('#..#....#...##......#....##....');
insert into toboggan (pattern) values ('#.#.......#....#.###.##..#..#..');
insert into toboggan (pattern) values ('..##...........#...#....#......');
insert into toboggan (pattern) values ('.#........#.....#..#..#...#..##');
insert into toboggan (pattern) values ('.....#.#.#..#.......#....#.....');
insert into toboggan (pattern) values ('#..#.#......#......##....#.....');
insert into toboggan (pattern) values ('##.....................##......');
insert into toboggan (pattern) values ('.##........###..#.........#...#');
insert into toboggan (pattern) values ('........#.........#..#.........');
insert into toboggan (pattern) values ('.#.##....#.....#...#.........##');
insert into toboggan (pattern) values ('....##......#.........#........');
insert into toboggan (pattern) values ('...#.#..#...##.##.#.#..####....');
insert into toboggan (pattern) values ('..##...........##.#.#....#.....');
insert into toboggan (pattern) values ('.#.....#.#...#..#.......#....#.');
insert into toboggan (pattern) values ('....#...#......##...#...##.#..#');
insert into toboggan (pattern) values ('....#..##....#..#.........##.#.');
insert into toboggan (pattern) values ('..##...##.##....#....##.###...#');
insert into toboggan (pattern) values ('..#....##..##.#.#.#...#......#.');
insert into toboggan (pattern) values ('##...#.........#...........#...');
insert into toboggan (pattern) values ('.##....##.#.....#...#.......#..');
insert into toboggan (pattern) values ('..........##.###.##....###....#');
insert into toboggan (pattern) values ('..........#..##..#....#.#.##.##');
insert into toboggan (pattern) values ('........##.#...#.#.#.#...###.#.');
insert into toboggan (pattern) values ('.#......#.#.#...###.#.#.#......');
insert into toboggan (pattern) values ('.........#......#......#...#..#');
insert into toboggan (pattern) values ('......#.....#.##....##.#####..#');
insert into toboggan (pattern) values ('..#..##...###.#..........#.#.#.');
insert into toboggan (pattern) values ('.#..#....###.#...#..#....#...##');
insert into toboggan (pattern) values ('...................#..........#');
insert into toboggan (pattern) values ('....###.....#...##......#.....#');
insert into toboggan (pattern) values ('#.....#..##.....#.#..........#.');
insert into toboggan (pattern) values ('..#.......##.#....#..#.##.#...#');
insert into toboggan (pattern) values ('........##.#..###..#......##...');
insert into toboggan (pattern) values ('#...........##.#...###..#....#.');
insert into toboggan (pattern) values ('....#...........#.....#.#...#..');
insert into toboggan (pattern) values ('.##..#.#...#...#.##...#..#.....');
insert into toboggan (pattern) values ('#........#.#.#.#.#.#...........');
insert into toboggan (pattern) values ('#..#.....#..#..#.##....#....#.#');
insert into toboggan (pattern) values ('..#............##....#.#.##...#');
insert into toboggan (pattern) values ('.....###.#....#.#......#.###...');
insert into toboggan (pattern) values ('...#.....#.#.................#.');
insert into toboggan (pattern) values ('..#...##..#.#...#...#...#.....#');
insert into toboggan (pattern) values ('.##.#........#..#....##..#..##.');
insert into toboggan (pattern) values ('.#..........#...#.#..#..#.#....');
insert into toboggan (pattern) values ('#.......##.........#.##..#.####');
insert into toboggan (pattern) values ('.#..............#.......##.....');
insert into toboggan (pattern) values ('#......#.##..........#..#......');
insert into toboggan (pattern) values ('..##...#...#.#...#............#');
insert into toboggan (pattern) values ('.##.##..##..##........##.....#.');
insert into toboggan (pattern) values ('.....#..#.....##...............');
insert into toboggan (pattern) values ('.#..#...##...#...#.....#.......');
insert into toboggan (pattern) values ('#......#...#.......#..##.###.##');
insert into toboggan (pattern) values ('###..##......##......###....#..');
insert into toboggan (pattern) values ('....#..........#...#.##.#.....#');
insert into toboggan (pattern) values ('.........#....#..#..#.#..##....');
insert into toboggan (pattern) values ('.....#.....#...........#......#');
insert into toboggan (pattern) values ('.#.......#...#....##...#.##...#');
insert into toboggan (pattern) values ('..##.#..............#..#...#.#.');
insert into toboggan (pattern) values ('.#..####.#.........#....#....#.');
insert into toboggan (pattern) values ('..###.#...#..#......#.......###');
insert into toboggan (pattern) values ('.#.#..##...###...#...#.#...#.#.');
insert into toboggan (pattern) values ('...#..##..###.#..#.....#.##....');
insert into toboggan (pattern) values ('#...###.#...##.....####.....#..');
insert into toboggan (pattern) values ('.#.##...#..#.#..##.....#.......');
insert into toboggan (pattern) values ('...#.##.....##.....#....#......');
insert into toboggan (pattern) values ('.#...##.....#..###..#..........');
insert into toboggan (pattern) values ('..........#...#.....#....##.#..');
insert into toboggan (pattern) values ('.......#...#...#...#........#..');
insert into toboggan (pattern) values ('#....##..#...#..##.#.#.....#...');
insert into toboggan (pattern) values ('.#.#..............#..#....#....');
insert into toboggan (pattern) values ('.####.#.#.###......#...#.#....#');
insert into toboggan (pattern) values ('.#...#...##.#...............#.#');
insert into toboggan (pattern) values ('...#.......##...#...#....##....');
insert into toboggan (pattern) values ('#..........###.##..........##.#');
insert into toboggan (pattern) values ('.......#...#....#.#..#.#....#..');
insert into toboggan (pattern) values ('....#.##.#...###..#..##.##.....');
insert into toboggan (pattern) values ('..#.#.#......#.#.......###.....');
insert into toboggan (pattern) values ('#..................#.##....#...');
insert into toboggan (pattern) values ('#.....#..#.#.#..#...#.........#');
insert into toboggan (pattern) values ('..#..#...#.#.##........#.......');
insert into toboggan (pattern) values ('#..#.#..#..........###...#.#...');
insert into toboggan (pattern) values ('.......#.##....#........##.#...');
insert into toboggan (pattern) values ('.####.#.#...#.#...##.##.....###');
insert into toboggan (pattern) values ('........#.#...#.#..##...##.....');
insert into toboggan (pattern) values ('....##.##......#.##.........#..');
insert into toboggan (pattern) values ('.#..#...#.#...........#........');
insert into toboggan (pattern) values ('.......#..........#....#...#...');
insert into toboggan (pattern) values ('..###.#.###..#..#.....#..##....');
insert into toboggan (pattern) values ('.#..........#.......##...#.....');
insert into toboggan (pattern) values ('.#.....#...#........#...#.##..#');
insert into toboggan (pattern) values ('.#..#.......#..#.......#.#.#...');
insert into toboggan (pattern) values ('....#..##.#...##...#.#....#....');
insert into toboggan (pattern) values ('.....#.........#..#..#....#....');
insert into toboggan (pattern) values ('..#.#..##....#..#..##.#.#.....#');
insert into toboggan (pattern) values ('........#.#...###....#.#.#.....');
insert into toboggan (pattern) values ('.#.....#.......#..###.#........');
insert into toboggan (pattern) values ('.......#...#.#...#...##........');
insert into toboggan (pattern) values ('##.............#.#.....#.#..#..');
insert into toboggan (pattern) values ('.#....#.......#.#.......#..##..');
insert into toboggan (pattern) values ('#.....#........#..##..##.......');
insert into toboggan (pattern) values ('...........#.........###......#');
insert into toboggan (pattern) values ('....#.##...#.#...#...#....#..##');
insert into toboggan (pattern) values ('......#..##......#......#.##.#.');
insert into toboggan (pattern) values ('......##....####...###...#.....');
insert into toboggan (pattern) values ('#....#..........#.#.##.....#..#');
insert into toboggan (pattern) values ('....#.#...........#.#.#.#.#...#');
insert into toboggan (pattern) values ('....####.....##...#..##..#...#.');
insert into toboggan (pattern) values ('#....#.###..###.....#..###.....');
insert into toboggan (pattern) values ('..##.........#......#...##.#...');
insert into toboggan (pattern) values ('..#.....#.#...#.##.#...#..###.#');
insert into toboggan (pattern) values ('..#.##..##........#.......#.###');
insert into toboggan (pattern) values ('.....#..........#.....#....#...');
insert into toboggan (pattern) values ('.......##..##..###.......#####.');
insert into toboggan (pattern) values ('..###......#.#....###....##...#');
insert into toboggan (pattern) values ('#..##.....#..###...#.....##.##.');
insert into toboggan (pattern) values ('#..#..##.##.###.####.##.#......');
insert into toboggan (pattern) values ('.#.#......#.##......#..#......#');
insert into toboggan (pattern) values ('..###.....#.#......#.#.####....');
insert into toboggan (pattern) values ('#..............#..#.#...#.###..');
insert into toboggan (pattern) values ('...#..#.##..........##.#...#.##');
insert into toboggan (pattern) values ('.#.#.#.........#....#.#..#.....');
insert into toboggan (pattern) values ('..#.##..#...#..#...#......#....');
insert into toboggan (pattern) values ('.......#...#.##.#.#..#...##..#.');
insert into toboggan (pattern) values ('..........#.####...#........#.#');
insert into toboggan (pattern) values ('....#...#....##.#.........#.#..');
insert into toboggan (pattern) values ('##.#..#.......###....#..#..#.#.');
insert into toboggan (pattern) values ('..##.....#..#.#.#.####......#..');
insert into toboggan (pattern) values ('.#.....#..........#..#..#.#....');
insert into toboggan (pattern) values ('......#.#.......#.#...#..#..#..');
insert into toboggan (pattern) values ('...#...............#....#...#..');
insert into toboggan (pattern) values ('##.......#.........#.......#...');
insert into toboggan (pattern) values ('...#.......###...#.#...#.......');
insert into toboggan (pattern) values ('#...###....#....##....#....#...');
insert into toboggan (pattern) values ('...#....##..#.#.............##.');
insert into toboggan (pattern) values ('.....#.#.#..#......#...#.#..#..');
insert into toboggan (pattern) values ('.##....#..##..#####..##.....##.');
insert into toboggan (pattern) values ('....##.#.#..#.....#.#...#......');
insert into toboggan (pattern) values ('...#.....##.#.#..##..#.#.......');
insert into toboggan (pattern) values ('.......#..#..#..........#......');
insert into toboggan (pattern) values ('.......#...#..#.........#.##...');
insert into toboggan (pattern) values ('..#..#..#...##..#.#....#......#');
insert into toboggan (pattern) values ('..#....#...#.#......#........#.');
insert into toboggan (pattern) values ('.#...#..#...#.#..........#.....');
insert into toboggan (pattern) values ('#..#...####..#......##.##.#.#..');
insert into toboggan (pattern) values ('.#...#.#...#.#.....#..##.#.....');
insert into toboggan (pattern) values ('..#.##.#......#.........##...#.');
insert into toboggan (pattern) values ('###..............#.............');
insert into toboggan (pattern) values ('...#...###....#..#.............');
insert into toboggan (pattern) values ('.##....#......#..#.....#..#..#.');
insert into toboggan (pattern) values ('.#..........#.....##...#..#....');
insert into toboggan (pattern) values ('....##..#.#......###.##......#.');
insert into toboggan (pattern) values ('.#..##.#.##.#...##.#......###.#');
insert into toboggan (pattern) values ('#..###.#...###..#........#.#...');
insert into toboggan (pattern) values ('#..#.#.#..#...###.##.##..#..#..');
insert into toboggan (pattern) values ('#.#..#....#.........##......#..');
insert into toboggan (pattern) values ('....###.....###....#...........');
insert into toboggan (pattern) values ('....#..##.##....##..#.....#....');
insert into toboggan (pattern) values ('.#.....#....####...#..##.#..###');
insert into toboggan (pattern) values ('.........##..#......#.#...##...');
insert into toboggan (pattern) values ('.##.......#.....#.###.#..#.#..#');
insert into toboggan (pattern) values ('.....#.#...###.....#......####.');
insert into toboggan (pattern) values ('##.#...#......#.#.#..#.####...#');
insert into toboggan (pattern) values ('.#.##.....#..#..#.............#');
insert into toboggan (pattern) values ('.#..###..#..#......#..##......#');
insert into toboggan (pattern) values ('.......#.#........##.....#.#...');
insert into toboggan (pattern) values ('#....#...#..###..#.#.....#.##..');
insert into toboggan (pattern) values ('.##.....#.#....###..#.....##...');
insert into toboggan (pattern) values ('...##....#....#...#....#.#.#...');
insert into toboggan (pattern) values ('#####..#...........###....#...#');
insert into toboggan (pattern) values ('.#.......##.##.....#....#......');
insert into toboggan (pattern) values ('.#..#.#...#..#......#...#..#.#.');
insert into toboggan (pattern) values ('....#.....##...#####..#...#...#');
insert into toboggan (pattern) values ('###.##...#.#............#....#.');
insert into toboggan (pattern) values ('.....#...#........##.........#.');
commit;

-- Part 1
select sum(decode(substr(pattern, mod(3*(rownum-1), length(pattern))+1, 1), '#', 1, 0)) part1_answer from toboggan order by id;

-- Part 2
with slope_data as (select row_number() over (order by id) rn, pattern p from toboggan order by id)
select r1d1.cnt * r3d1.cnt * r5d1.cnt * r7d1.cnt * r1d2.cnt part2_answer from
(select sum(decode(substr(p, mod(1*(rownum-1), length(p))+1, 1), '#', 1, 0)) cnt from slope_data) r1d1, 
(select sum(decode(substr(p, mod(3*(rownum-1), length(p))+1, 1), '#', 1, 0)) cnt from slope_data) r3d1, 
(select sum(decode(substr(p, mod(5*(rownum-1), length(p))+1, 1), '#', 1, 0)) cnt from slope_data) r5d1, 
(select sum(decode(substr(p, mod(7*(rownum-1), length(p))+1, 1), '#', 1, 0)) cnt from slope_data) r7d1, 
(select sum(decode(substr(p, mod(1*(rownum-1), length(p))+1, 1), '#', 1, 0)) cnt from slope_data where mod(rn,2)=1) r1d2;
